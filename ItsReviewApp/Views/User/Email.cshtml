
@{
    ViewBag.Title = "Email";
}

@*<div class="container-fluid">
    <div class="header">
        <h5 style="color:#fff;margin-right: 40px;">ItsReview App</h5>
    </div>

</div>*@
@*<div class="container" style="margin-top:30px;">*@
   
        <div class="form-group" id="companyid">
            <label>Select Company: </label>
            <div>
                @Html.DropDownList("CompanyName", (IEnumerable<SelectListItem>)ViewBag.Company, "-- select --", new { @class = "form-control chosen"})
            </div>
        </div>
        <div class="form-group">
            <input type="file" id="files" name="files"/><br />
            <input type="button" id="excelupload" value="Upload" class="btn btn-primary btn-md btn-sm" />
        </div>
   
@*</div>*@

<script type="text/javascript">
    $(document).ready(function () {
        $(".chosen").chosen();
    })

    $('#excelupload').click(function () {
         var CompanyId = $("#companyid option:selected").val();
        var fileUpload = $("#files").get(0);
        var files = fileUpload.files;
        var fileData = new FormData();
        fileData.append('CompanyId', CompanyId);
        for (var i = 0; i < files.length; i++) {
            fileData.append(files[i].name, files[i]);
        }


        $.ajax({
            url: "@Url.Action("TrackingEmailUpload", "User")",
           type: "POST",
           processData: false,
           contentType: false,
             data: fileData,
            success: function (result) {
               
                if (result.length != 0) {
                    alert(result);
                   // alert("Email Does not Exist: \n" + result.toString().replaceAll(",", "\n"));
                }
                else {
                    $("#files").val('');
                    alert('Upload Successfully');
                }
            },
            error: function (result) {
                alert('failure');
            }
        });
    })


</script>